{{/* saved as list.html in tokyo-mistakes/layouts/podcast */}}
{{ define "main" }}
<div class="podcast-list">
  <div class="container">
    {{ partial "breadcrumbs.html" . }}
    
    <header class="list-header">
      <h1 class="list-title">{{ .Title }}</h1>
      <p class="list-description">{{ .Description }}</p>
    </header>

    <!-- Page Content -->
    <div class="podcast-intro">
      {{ .Content }}
    </div>

    <!-- Pinned Episodes -->
    {{ $pinnedPosts := where .Pages "Params.pinned" true }}
    {{ if $pinnedPosts }}
    <div class="pinned-posts">
      <h2 class="pinned-heading">Featured Episodes</h2>
      <div class="post-grid">
        {{ range $pinnedPosts }}
        <div class="post-card post-card--pinned">
          {{ $postImage := .Params.post_image | default .Params.image | default "/images/podcast-logo-banner.png" }}
          <div class="post-card-image" style="background-image: url('{{ $postImage }}');">
            <a href="{{ .Permalink }}" class="post-card-link" aria-label="{{ .Title }}"></a>
            <div class="post-card-pin"><i class="fas fa-thumbtack"></i></div>
          </div>
          <div class="post-card-content">
            <h2 class="post-card-title">
              <a href="{{ .Permalink }}">{{ .Title }}</a>
            </h2>
            <div class="post-card-meta">
              <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
              {{ if .Params.episode_number }}
              <span class="post-card-episode">Episode #{{ .Params.episode_number }}</span>
              {{ end }}
            </div>
            {{ if .Summary }}
            <div class="post-card-excerpt">
              {{ .Summary | truncate 120 }}
            </div>
            {{ end }}
          </div>
        </div>
        {{ end }}
      </div>
    </div>
    {{ end }}

    <!-- Regular Episodes -->
    {{ $regularPosts := where .Pages "Params.pinned" "!=" true }}
    {{ if $regularPosts }}
    <div class="post-grid">
      {{ range $regularPosts }}
      <div class="post-card">
        {{ $postImage := .Params.post_image | default .Params.image | default "/images/podcast-logo-banner.png" }}
        <div class="post-card-image" style="background-image: url('{{ $postImage }}');">
          <a href="{{ .Permalink }}" class="post-card-link" aria-label="{{ .Title }}"></a>
        </div>
        <div class="post-card-content">
          <h2 class="post-card-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h2>
          <div class="post-card-meta">
            <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
            {{ if .Params.episode_number }}
            <span class="post-card-episode">Episode #{{ .Params.episode_number }}</span>
            {{ end }}
          </div>
          {{ if .Summary }}
          <div class="post-card-excerpt">
            {{ .Summary | truncate 120 }}
          </div>
          {{ end }}
        </div>
      </div>
      {{ end }}
    </div>
    {{ else }}
    <div class="no-episodes">
      <p>No episodes available yet. Check back soon!</p>
    </div>
    {{ end }}

    <!-- Pagination -->
    {{ template "_internal/pagination.html" . }}
  </div>
</div>
{{ end }}
