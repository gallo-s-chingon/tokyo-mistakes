{{/* layouts/featured/list.html */}}
{{ define "main" }}
<div class="featured-list">
  <div class="container">
    {{ partial "breadcrumbs.html" . }}

    <header class="list-header">
      <h1 class="list-title">{{ .Title }}</h1>
      <p class="list-description">{{ .Description }}</p>

      {{ if eq .Paginator.PageNumber 1 }}
      <div class="list-actions">
        <a href="#appearances" class="btn btn-primary">
          <i class="fas fa-arrow-down"></i>
          Jump to Appearances
        </a>
      </div>
      {{ end }}
    </header>

    {{ if eq .Paginator.PageNumber 1 }}
    <div class="featured-intro">
      <div class="content">
        {{ .Content | safeHTML }}
      </div>
    </div>
    {{ end }}

    <div id="appearances" class="appearances-section">
      <h2 class="appearances-title">Guest Appearances</h2>

      {{ $pinnedPosts := where .Pages "Params.pinned" true }}
      {{ if $pinnedPosts }}
      <div class="pinned-posts">
        <h3 class="pinned-heading">Highlighted Appearances</h3>
        <div class="post-grid">
          {{ range $pinnedPosts }}
          <div class="post-card post-card--pinned">
            {{ $postImage := .Params.post_image | default .Params.image }}
            {{ if $postImage }}
            <div class="post-card-image" style="background-image: url('{{ $postImage }}');">
              <a href="{{ .Permalink }}" class="post-card-link" aria-label="{{ .Title }}"></a>
              <div class="post-card-pin"><i class="fas fa-thumbtack"></i></div>
            </div>
            {{ end }}
            <div class="post-card-content">
              <h2 class="post-card-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
              <div class="post-card-meta">
                <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
                {{ if .Params.podcast_name }}<span class="post-card-podcast">{{ .Params.podcast_name }}</span>{{ end }}
              </div>
              {{ with .Summary }}<div class="post-card-excerpt">{{ . | truncate 120 }}</div>{{ end }}
            </div>
          </div>
          {{ end }}
        </div>
      </div>
      {{ end }}

      {{ $regularPosts := where .Pages "Params.pinned" "!=" true }}
      {{ if $regularPosts }}
      <div class="post-grid">
        {{ range $regularPosts }}
        <div class="post-card">
          {{ $postImage := .Params.post_image | default .Params.image }}
          {{ if $postImage }}
          <div class="post-card-image" style="background-image: url('{{ $postImage }}');">
            <a href="{{ .Permalink }}" class="post-card-link" aria-label="{{ .Title }}"></a>
          </div>
          {{ end }}
          <div class="post-card-content">
            <h2 class="post-card-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
            <div class="post-card-meta">
              <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
              {{ if .Params.podcast_name }}<span class="post-card-podcast">{{ .Params.podcast_name }}</span>{{ end }}
            </div>
            {{ with .Summary }}<div class="post-card-excerpt">{{ . | truncate 120 }}</div>{{ end }}
          </div>
        </div>
        {{ end }}
      </div>
      {{ else }}
      <div class="no-appearances"><p>No appearances available yet. Check back soon!</p></div>
      {{ end }}

      {{ template "_internal/pagination.html" . }}
    </div>
  </div>
</div>
{{ end }}
