{{ $type := .Get "type" | default "episode" }}
{{ $id := .Get "id" | default (.Get 0) }}
{{ $height := .Get "height" | default "232" }}
{{ $title := .Get "title" | default "Spotify Audio" }}

{{ if not $id }}
  <div class="shortcode-error">
    <p><strong>Error:</strong> Spotify shortcode requires an ID parameter.</p>
    <p><strong>Usage:</strong> <code>{{</* spotify id="EPISODE_ID" */>}}</code></p>
    <p><strong>Example:</strong> <code>{{</* spotify id="4rOoJ6Egrf8K2IrywzwOMk" */>}}</code></p>
  </div>
{{ else }}
  <div class="embed-container embed-spotify" style="height: {{ $height }}px; padding-bottom: 0;">
    <iframe 
      src="https://open.spotify.com/embed/{{ $type }}/{{ $id }}?utm_source=generator&theme=0" 
      width="100%" 
      height="{{ $height }}" 
      frameborder="0" 
      allowfullscreen="" 
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      loading="lazy"
      title="{{ $title }}">
    </iframe>
  </div>
{{ end }}

<style>
.embed-spotify {
  margin: 2rem 0;
  border-radius: 8px;
  overflow: hidden;
}

.shortcode-error {
  background-color: var(--bg-secondary);
  border: 1px solid var(--error);
  border-radius: 8px;
  padding: 1rem;
  margin: 2rem 0;
  color: var(--error);
}

.shortcode-error code {
  background-color: var(--code-bg);
  padding: 2px 6px;
  border-radius: 4px;
  font-family: monospace;
}
</style>
