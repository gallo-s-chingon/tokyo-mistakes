{{ $url := .Get "url" | default (.Get 0) }}
{{ $height := .Get "height" | default "175" }}
{{ $title := .Get "title" | default "Apple Podcasts" }}

{{ if not $url }}
  <div class="shortcode-error">
    <p><strong>Error:</strong> Apple Podcast shortcode requires a URL parameter.</p>
    <p><strong>Usage:</strong> <code>{{</* apple-podcast url="EMBED_URL" */>}}</code></p>
    <p><strong>How to get URL:</strong></p>
    <ol>
      <li>Go to your podcast in Apple Podcasts</li>
      <li>Click the episode</li>
      <li>Click the share button</li>
      <li>Select "Copy Embed Code"</li>
      <li>Extract the src URL from the iframe</li>
    </ol>
  </div>
{{ else }}
  <div class="embed-container embed-apple-podcast" style="height: {{ $height }}px; padding-bottom: 0;">
    <iframe 
      src="{{ $url }}" 
      width="100%" 
      height="{{ $height }}" 
      frameborder="0" 
      sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
      allow="autoplay *; encrypted-media *; fullscreen *; clipboard-write"
      loading="lazy"
      title="{{ $title }}">
    </iframe>
  </div>
{{ end }}

<style>
.embed-apple-podcast {
  margin: 2rem 0;
  border-radius: 8px;
  overflow: hidden;
}

.shortcode-error {
  background-color: var(--bg-secondary);
  border: 1px solid var(--error);
  border-radius: 8px;
  padding: 1rem;
  margin: 2rem 0;
  color: var(--error);
}

.shortcode-error code {
  background-color: var(--code-bg);
  padding: 2px 6px;
  border-radius: 4px;
  font-family: monospace;
}

.shortcode-error ol {
  text-align: left;
  margin-top: 1rem;
}

.shortcode-error li {
  margin: 0.5rem 0;
}
</style>
