{{/* saved as comments.html in tokyo-mistakes/layouts/partials */}}
{{ if .Site.Params.comments.enabled }}
  {{ if .Site.Params.comments.giscus }}
    {{ partial "giscus.html" . }}
  {{ else if .Site.Params.comments.remark42 }}
    <!-- Your existing Remark42 code -->
    <div class="comments-section">
      <h3 class="comments-title">Join the Conversation</h3>
      <div class="comments-notice">
        <p>
          <strong>Share your thoughts!</strong> By commenting below, you'll be
          subscribed to our newsletter for updates on new episodes and relationship
          insights.
        </p>
      </div>
      <div id="remark42"></div>
      <script>
        var remark_config = {
          host: "{{ .Site.Params.comments.remark42.host }}",
          site_id: "{{ .Site.Params.comments.remark42.site_id }}",
          url: "{{ .Permalink }}",
          components: ["embed"],
          theme:
            document.documentElement.getAttribute("data-theme") === "dark"
              ? "dark"
              : "light",
        };
        // Update theme when user switches
        document.addEventListener("themeChanged", function (e) {
          if (window.REMARK42) {
            window.REMARK42.changeTheme(e.detail.theme);
          }
        });
        (function (c) {
          for (var i = 0; i < c.length; i++) {
            var d = document,
              s = d.createElement("script");
            s.src = remark_config.host + "/web/" + c[i] + ".js";
            s.defer = true;
            (d.head || d.body).appendChild(s);
          }
        })(remark_config.components || ["embed"]);
      </script>
    </div>
  {{ end }}
{{ end }}
